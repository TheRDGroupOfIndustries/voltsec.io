"use client";
import React from "react";
import Link from "next/link";

import convertToReadableDateTime from "@/lib/DateConvertor";
import { Pentest as PentestType } from "@prisma/client";

const Pentest = ({ pentests }: { pentests: PentestType[] }) => {
  return (
    <section className="bg-gray-50 p-4 dark:bg-gray-900">
      <div className="flex flex-row items-center justify-between text-center">
        <h2 className="mx-1 md:m-2 p-2 py-2 text-2xl text-left font-semibold text-gray-700">
          Pentest History
        </h2>
        <div className=" flex flex-row">
          <Link href="/pentest/">
            <h2 className="m-2 cursor-pointer border-blue-500 rounded-3xl border p-2 py-2 text-base  bg-[#3b83f652] text-blue-400 hover:bg-[#3b83f686]">
              Create Pentest{" "}
            </h2>
          </Link>
        </div>
      </div>
      <div className="relative overflow-hidden rounded-3xl border dark:bg-gray-800 ">
        <div className="overflow-x-auto">
          <table className="w-full text-left text-sm text-gray-500 dark:text-gray-400">
            <thead className="bg-[#3b83f652] text-blue-400 text-xs capitalize ">
              <tr>
                <th scope="col" className="w-2 md:w-5 px-4 py-3">
                  Sr.No.
                </th>
                <th scope="col" className="px-4 py-3">
                  Pentest Type
                </th>
                <th scope="col" className="px-4 py-3">
                  Scope
                </th>
                <th scope="col" className="px-4 py-3">
                  Pentest Status
                </th>
                <th scope="col" className="px-4 py-3">
                  Date Created
                </th>
                <th scope="col" className="px-4 py-3">
                  User Email
                </th>
              </tr>
            </thead>

            <tbody>
              {pentests.length !== 0 ? (
                <>
                  {pentests.map(
                    (
                      { id, date, pentestStatus, pentestType, scope, email },
                      index
                    ) => {
                      return (
                        <tr
                          key={id}
                          className="border-b text-slate-800 border-gray-700 dark:bg-gray-800"
                        >
                          <th
                            scope="row"
                            className="whitespace-nowrap px-4 py-3 font-medium"
                          >
                            {index + 1}
                          </th>
                          <td className="px-4 py-3">{pentestType}</td>
                          <td className="truncate px-4 py-3">{scope}</td>
                          <td className="px-4 py-3">{pentestStatus}</td>
                          <td className="px-4 py-3">
                            {convertToReadableDateTime(date!)}
                          </td>
                          <td className="px-4 py-3">{email}</td>
                        </tr>
                      );
                    }
                  )}
                </>
              ) : (
                <>
                  <div className="flex flex-row p-10">No Pentests found.</div>
                </>
              )}
            </tbody>
          </table>
        </div>
      </div>
    </section>
  );
};

export default Pentest;
