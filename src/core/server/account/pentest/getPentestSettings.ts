import { db } from "@/core/client/client";
import getSessionOrRedirect from "../../utils/getSessionOrRedirect";

export const getPentestSettings = async () => {
  const session = await getSessionOrRedirect();

  const pentestSettings = await db.pentestsettings.findFirst({
    where: { email: session.user.email },
  });
  if (pentestSettings) return pentestSettings;

  return await db.pentestsettings.create({
    data: {
      selectedBot: "VOLTBOT",
      selectedScanMode: "LIGHTSCAN",
      email: session.user.email,
      User: { connect: { id: session.user.id } },
    },
  });
};
